---
description: 重述需求、评估风险，并创建分步实施计划。在修改任何代码之前必须等待用户确认。
---

# Plan 命令

此命令调用 **planner** 代理，在编写任何代码之前创建全面的实施计划。

## 命令功能

1. **重述需求** - 明确需要构建的内容
2. **识别风险** - 揭示潜在问题和阻碍因素
3. **创建分步计划** - 将实施分解为多个阶段
4. **等待确认** - 在继续之前必须获得用户批准

## 使用场景

在以下情况下使用 `/plan`：
- 开始新功能开发
- 进行重大架构变更
- 进行复杂的重构
- 多个文件/组件会受到影响
- 需求不明确或模糊

## 工作原理

planner 代理将：

1. **分析请求** 并用清晰的术语重述需求
2. **分解为阶段** 包含具体、可操作的步骤
3. **识别依赖关系** 组件之间
4. **评估风险** 和潜在阻碍因素
5. **估算复杂度** （高/中/低）
6. **展示计划** 并等待您的明确确认

## 使用示例

```
用户: /plan 添加渐变文本效果组件

代理 (planner):
# 实施计划：渐变文本效果组件

## 需求重述
为 MagicUI 添加渐变文本效果，支持：
- 任意渐变颜色配置
- 与现有 View 扩展系统集成
- 支持链式调用
- 多种预设渐变样式

## 实施阶段

### 阶段 1：创建渐变文本 View 扩展
- 在 `ExtView+/` 创建 `View+GradientText.swift`
- 实现 `gradientText(colors:startPoint:endPoint:)` 方法
- 使用 SwiftUI 的 LinearGradient 和 mask
- 返回 some View

### 阶段 2：添加便捷方法
- 实现常用预设渐变
  - `gradientTextBlue()` - 蓝紫渐变
  - `gradientTextSunset()` - 日落渐变
  - `gradientTextOcean()` - 海洋渐变
- 保持 API 一致性

### 阶段 3：创建预览示例
- 添加多个 #Preview 展示不同效果
- 展示不同字体大小
- 展示自定义渐变配置
- 演示链式调用

### 阶段 4：添加文档注释
- 为公共 API 添加中文注释
- 提供使用示例
- 说明参数含义

## 依赖项
- SwiftUI（系统框架）
- 无外部依赖

## 风险
- 低：实现简单，风险很低
- 低：兼容性好，无平台特定代码

## 预估复杂度：低
- 渐变文本实现：30 分钟
- 便捷方法：30 分钟
- 预览和文档：30 分钟
- 总计：1.5 小时

**等待确认**：是否继续此计划？（是/否/修改）
```

## 重要说明

**关键**：planner 代理在您明确使用"是"、"继续"或类似肯定回复确认计划之前，**不会**编写任何代码。

如果您想要修改，请回复：
- "修改：[您的修改内容]"
- "不同方法：[替代方案]"
- "跳过阶段 2，先做阶段 3"

## 规划原则

### 1. 模块化设计

- View 扩展放在 `ExtView+/` 目录
- 独立组件放在对应的功能目录（如 `Button/`、`Card/`）
- 每个功能独立文件（`View+Feature.swift`）

### 2. 遵循现有模式

- 参考现有 View 扩展实现
- 保持一致的代码风格和结构
- 返回 `some View` 支持链式调用
- 使用清晰的命名（magic 前缀或介词 in、with）

### 3. 性能考虑

- 避免在 View 中进行复杂计算
- 使用 computed properties
- 合理使用 @State 和 @Binding

### 4. API 设计

- 提供灵活的基础方法
- 提供常用配置的便捷方法
- 合理的默认值
- 详细的中文注释

## 与其他命令的集成

规划完成后：
- 使用 `/swift-check` 检查代码规范
- 如果出现构建错误，使用 `/build-fix`
- 使用 `/code-review` 审查完成的实施
- 使用 `/commit` 生成提交信息

## 常见功能规划模板

### 添加新的 View 扩展

```
1. 在 ExtView+/ 创建 View+Feature.swift
2. 实现 View 扩展，返回 some View
3. 支持链式调用
4. 添加便捷方法
5. 预览和文档
```

### 添加新的组件

```
1. 设计组件接口
2. 创建 State 管理
3. 实现主体 View
4. 添加 View 扩展集成
5. 预览和文档
```

### 添加新的背景主题

```
1. 在 Background/ 创建新主题文件
2. 实现动画和渐变
3. 添加到主题枚举
4. 创建预览
5. 文档注释
```

## 相关代理

此命令调用位于以下位置的 `planner` 代理：
`.claude/agents/planner.md`
